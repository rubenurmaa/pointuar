<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ca">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ranking Gourmet</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: linear-gradient(135deg, #8bc34a, #4caf50); margin:0; padding:20px; display:flex; justify-content:center; align-items:flex-start; min-height:100vh; }
        .container { background-color: rgba(255,255,255,0.95); padding: 20px 30px; border-radius: 12px; box-shadow: 0 4px 20px rgba(0,0,0,0.2); width:90%; max-width:1000px; }
        h2 { text-align: center; color: #2e7d32; margin-bottom: 20px; }
        a.button { display:inline-block; margin-bottom:15px; padding:10px 20px; background-color:#2e7d32; color:white; text-decoration:none; border-radius:8px; transition: background 0.2s; }
        a.button:hover { background-color:#256f29; }
        table { width:100%; border-collapse: collapse; margin-top:10px; }
        table, th, td { border:1px solid #ddd; }
        th, td { padding:10px; text-align:center; font-size:14px; }
        th { background-color:#2e7d32; color:white; cursor:pointer; position:relative; }
        th:hover { background-color:#256f29; }
        tr:nth-child(even) { background-color:#f9f9f9; }
        .message { text-align:center; margin-top:15px; font-weight:bold; color:#2a7a2e; }
        .message.error { color:#c62828; }
        @media(max-width:768px){
            table, thead, tbody, th, td, tr{ display:block; }
            thead tr{ display:none; }
            tr{ margin-bottom:15px; border:1px solid #ccc; border-radius:8px; padding:10px; }
            td{ text-align:right; padding-left:50%; position:relative; }
            td::before{ content:attr(data-label); position:absolute; left:10px; width:calc(50%-20px); font-weight:bold; text-align:left; }
        }
    </style>
</head>
<body>
<div class="container">
    <h2>Ranking Gourmet üçΩÔ∏è</h2>
    <a th:href="@{/ranking}" class="button">‚ûï Afegir nou local</a>
    <a th:href="@{/}" class="button">üè† Tornar a l'inici</a>
    <hr>
    <table id="rankingTable">
        <thead>
            <tr>
                <th>Nom</th><th>Ubicaci√≥</th><th>Data</th><th>Men√∫</th><th>Preu (‚Ç¨)</th><th>Menjar</th><th>Rapidesa</th><th>Quantitat</th><th>Preu</th><th>Mitjana</th>
            </tr>
        </thead>
        <tbody>
            <tr th:each="r : ${locals}">
                <td data-label="Nom" th:text="${r.nomLocal}"></td>
                <td data-label="Ubicaci√≥" th:text="${r.ubicacio}"></td>
                <td data-label="Data" th:text="${r.dataVisita}"></td>
                <td data-label="Men√∫" th:text="${r.menu}"></td>
                <td data-label="Preu (‚Ç¨)" th:text="${r.preuTotal}"></td>
                <td data-label="Menjar" th:text="${r.menjar}"></td>
                <td data-label="Rapidesa" th:text="${r.rapidesa}"></td>
                <td data-label="Quantitat" th:text="${r.quantitat}"></td>
                <td data-label="Preu" th:text="${r.preu}"></td>
                <td data-label="Mitjana" th:text="${r.mitjana}"></td>
				<td data-label="Accions">
				      <a th:href="@{/ranking/edit/{id}(id=${r.id})}" class="button">Editar</a>
            </tr>
        </tbody>
    </table>
</div>
<script>
document.addEventListener('DOMContentLoaded', function () {
    const table = document.getElementById('rankingTable');
    const headers = table.querySelectorAll('th');
    let sortDirection = {};
    headers.forEach((header, index) => {
        header.addEventListener('click', () => {
            const rows = Array.from(table.querySelectorAll('tbody tr'));
            const asc = !sortDirection[index]; sortDirection = {}; sortDirection[index] = asc;
            headers.forEach(h => h.classList.remove('sort-asc','sort-desc'));
            header.classList.add(asc ? 'sort-asc' : 'sort-desc');
            rows.sort((a,b)=>{
                const A = a.children[index].innerText.toLowerCase();
                const B = b.children[index].innerText.toLowerCase();
                const numA = parseFloat(A); const numB = parseFloat(B);
                if(!isNaN(numA)&&!isNaN(numB)) return asc?numA-numB:numB-numA;
                return asc?A.localeCompare(B):B.localeCompare(A);
            });
            const tbody = table.querySelector('tbody'); rows.forEach(row=>tbody.appendChild(row));
        });
    });
});
</script>
</body>
</html>
